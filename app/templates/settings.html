{% extends 'base.html' %}

{% block body %}

<div class="content my-5">

    <h1>Информация о пользователе</h1>
    <div id="user-info">
        <p id="user-data">Загрузка данных пользователя...</p>
    </div>
    <div id="error-message" class="error" style="display: none;">
        <!-- Ошибка будет отображаться здесь -->
    </div>

    <script>
        // Функция для безопасного отображения данных
        function displayData(data) {
            return data || 'Недоступно';
        }

        // Инициализация WebApp
        const tg = window.Telegram.WebApp;

        try {
            
            // Получение данных пользователя
            const user = tg.initDataUnsafe.WebAppInitData.WebAppUser;

            if (user) {
                // Данные пользователя
                const userDataElement = document.getElementById('user-data');
                userDataElement.innerHTML = `
                    <strong>ID:</strong> ${displayData(user.id)}<br>
                    <strong>Имя:</strong> ${displayData(user.first_name)}<br>
                    <strong>Фамилия:</strong> ${displayData(user.last_name)}<br>
                    <strong>Никнейм:</strong> ${displayData(user.username)}<br>
                    <strong>Аватар:</strong> ${user.photo_url ? `<a href="${user.photo_url}" target="_blank">Посмотреть</a>` : 'Нет'}
                `;
            } else {
                throw new Error('Данные пользователя недоступны.');
            }
        } catch (error) {
            // Отображение ошибки
            const errorMessageElement = document.getElementById('error-message');
            errorMessageElement.style.display = 'block';
            errorMessageElement.innerText = `Ошибка: ${error.message}`;
        }
    </script>
    <!-- Balance -->
    <div class="telegram-card">
        <div class="telegram-card-header">
            Настройки
        </div>

        <div class="telegram-card-content">
            <form>
                <!-- Имя, Фамилия и Username -->
                <label class="text-muted">ОБЯЗАТЕЛЬНО</label>
                <input type="text" class="form-input" placeholder="Имя">
                    <div class="telecram-card-content mb-2 p-1">
                        Имя не может быть пустым!
                    </div>
                <label class="text-muted">НЕ ОБЯЗАТЕЛЬНО</label>
                <input type="text" class="form-input" placeholder="Фамилия">
                <label class="text-muted">КОРОТКОЕ ИМЯ ПОЛЬЗОВАТЕЛЯ</label>
                <input type="text" class="form-input" placeholder="@username">
                <div class="telecram-card-content mb-2 p-1">
                    Если короткое имя не показывается, значит оно не установлено у вас в телеграм!
                    Для корректной работы приложения, либо укажите его в телеграм, либо тут, заполнив поле. (Без @)
                </div>

               <div class="telegram-card-header">
                Язык и регион
               </div>
                <!-- Выпадающий список Язык -->
                <select class="form-select">
                    <option value="ru">Русский</option>
                    <option value="en">English</option>
                    <option value="de">Deutsch</option>
                </select>
                <!-- Выпадающий список Валюта -->
                <select class="form-select">
                    <option value="usd">USD</option>
                    <option value="eur">EUR</option>
                    <option value="rub">RUB</option>
                </select>

            </form>
        </div>

        <div class="telegram-card-footer">
            <!-- Можно добавить действия в футер -->
        </div>
    </div>

    <div class="telegram-card">
        <div class="telegram-card-header">
            Уведомления
           </div>

        <!-- Свайп-туглер с текстом -->
        <div class="checkbox-container">
            <span>Включить уведомления</span>
            <label>
                <div class="toggle-checkbox">
                    <input type="checkbox">
                    <span class="slider"></span>
                </div>
            </label>
        </div>
    </div>
    <!-- Всплывающий футер -->
<div class="floating-footer">
    <button class="btn btn-tg-theme btn-submit">Save</button>
</div>
</div>
{% endblock body %}